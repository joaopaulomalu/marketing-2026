<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planejamento de Marketing 2026</title>
    
    <!-- Bibliotecas Externas -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        /* Configurações Globais */
        body { 
            font-family: 'Inter', system-ui, sans-serif; 
            background-color: #f8fafc; 
            color: #0f172a; 
            -webkit-font-smoothing: antialiased;
        }

        h1, h2, h3 { letter-spacing: -0.025em; }

        /* Animações */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* --- NAVEGAÇÃO SEGMENTADA MODERNA --- */
        .nav-wrapper {
            @apply flex justify-center md:justify-start w-full md:w-auto mt-4 md:mt-0;
        }
        
        .nav-container {
            @apply flex p-1.5 bg-slate-100 rounded-2xl border border-slate-200/60 gap-1 overflow-x-auto w-full md:w-auto shadow-inner;
        }
        
        .nav-tab {
            @apply px-5 py-2.5 rounded-xl text-sm font-bold text-slate-500 transition-all duration-300 flex items-center justify-center gap-2.5 whitespace-nowrap outline-none select-none w-full md:w-auto;
        }
        
        .nav-tab:hover:not(.active) { @apply bg-slate-200/50 text-slate-700; }
        .nav-tab.active { @apply bg-white text-blue-700 shadow-[0_2px_8px_rgba(0,0,0,0.08)] ring-1 ring-black/5 transform scale-[1.0]; }
        .nav-tab.active i { @apply text-blue-600; }

        /* Cards e Layout */
        .chart-container { position: relative; width: 100%; height: 220px; }
        .article-card { transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1); border-left: 4px solid #cbd5e1; }
        .article-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.05); }
        .article-card.completed { background-color: #f0fdf4; border-left-color: #22c55e !important; opacity: 0.8; }
        .article-card.completed h4 { text-decoration: line-through; color: #16a34a; }

        /* Cores de Categoria */
        .border-imob { border-left-color: #2563eb !important; }
        .border-inv { border-left-color: #059669 !important; }
        .border-exec { border-left-color: #dc2626 !important; }
        .border-custom { border-left-color: #7c3aed !important; background-color: #fcfaff; }

        /* --- TABELA OTIMIZADA (10px) --- */
        .spreadsheet-table th { 
            @apply bg-slate-50 text-slate-500 font-bold text-[10px] uppercase tracking-wider py-2 px-3 text-left border-b border-gray-200; 
        }
        .spreadsheet-table td { 
            @apply py-2 px-3 border-b border-gray-50 text-[10px] text-slate-600 align-middle; 
        }
        .status-done { 
            @apply bg-emerald-50 text-emerald-700 px-1.5 py-0.5 rounded text-[9px] font-bold inline-flex items-center gap-1 border border-emerald-100 uppercase tracking-wide; 
        }
        .status-pending { 
            @apply bg-slate-50 text-slate-400 px-1.5 py-0.5 rounded text-[9px] font-bold inline-flex items-center gap-1 border border-slate-200 uppercase tracking-wide; 
        }

        /* Botões Especiais */
        .sparkle-btn { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); transition: all 0.3s ease; }
        .sparkle-btn:hover { filter: brightness(1.1); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25); }
        .action-btn { @apply flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-bold text-sm transition-all shadow-sm border bg-white text-slate-600 border-slate-200 hover:border-blue-300 hover:text-blue-700 hover:shadow-md; }
        .btn-add-custom { @apply bg-slate-900 text-white hover:bg-slate-800 px-4 py-2 rounded-lg font-bold text-xs uppercase tracking-wide shadow-lg flex items-center gap-2 transition-all hover:translate-y-[-1px]; }
        
        /* Badges */
        .badge-channel { @apply text-[9px] px-1.5 py-0.5 rounded-md font-bold uppercase tracking-wide border; }
        .ch-instagram { @apply bg-pink-50 text-pink-600 border-pink-100; }
        .ch-linkedin { @apply bg-blue-50 text-blue-700 border-blue-100; }

        /* Redes Sociais */
        .social-card { border-left: 4px solid; transition: transform 0.2s; }
        .social-card:hover { transform: translateX(4px); }
        .social-fb { border-color: #1877f2; }
        .social-li { border-color: #0a66c2; }
        .social-jb { border-color: #f59e0b; }
        .social-gmb { border-color: #4285f4; }
        
        /* Utilitários */
        .hidden-tab { display: none; }
        .modal-overlay { background-color: rgba(15, 23, 42, 0.6); backdrop-filter: blur(8px); }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-col lg:flex-row justify-between items-center gap-4">
                <div class="flex items-center gap-4 w-full lg:w-auto">
                    <div class="bg-gradient-to-br from-slate-900 to-slate-800 text-white p-3 rounded-xl shadow-lg shadow-slate-200">
                        <i class="fas fa-chart-pie text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-extrabold text-slate-900 tracking-tight leading-none">Planejamento de Marketing 2026</h1>
                        <div class="flex items-center gap-2 mt-1">
                            <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                            <span class="text-[11px] font-medium text-slate-500 uppercase tracking-wide">Direito Imobiliário & Cível</span>
                        </div>
                    </div>
                </div>

                <div class="nav-wrapper">
                    <div class="nav-container">
                        <button onclick="switchTab('calendar')" id="tab-calendar" class="nav-tab active">
                            <i class="far fa-calendar-alt text-lg"></i><span>Calendário Editorial</span>
                        </button>
                        <button onclick="switchTab('social')" id="tab-social" class="nav-tab">
                            <i class="fas fa-share-nodes text-lg"></i><span>Estratégia</span>
                        </button>
                        <button onclick="switchTab('report')" id="tab-report" class="nav-tab">
                            <i class="fas fa-table-list text-lg"></i><span>Relatório & Backup</span>
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center gap-3 w-full lg:w-auto justify-end">
                    <button onclick="openSettingsModal()" class="w-10 h-10 flex items-center justify-center text-slate-400 hover:text-slate-800 hover:bg-slate-100 rounded-full transition-all" title="Configurar API Key"><i class="fas fa-cog text-lg"></i></button>
                    <div class="flex items-center gap-4 bg-slate-50 px-4 py-2 rounded-full border border-slate-200">
                        <div class="flex flex-col items-end leading-none">
                            <span class="text-[9px] text-slate-400 font-bold uppercase tracking-wider">Meta Anual</span>
                            <span id="globalProgressText" class="text-sm font-bold text-slate-700">0/36</span>
                        </div>
                        <div class="w-20 bg-slate-200 rounded-full h-1.5 overflow-hidden">
                            <div id="globalProgressBar" class="bg-emerald-500 h-1.5 rounded-full transition-all duration-700 w-0 shadow-[0_0_8px_rgba(16,185,129,0.5)]"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 flex-1 max-w-7xl">
        
        <!-- CALENDÁRIO -->
        <div id="view-calendar" class="grid grid-cols-1 lg:grid-cols-12 gap-8 animate-fade-in">
            <div class="lg:col-span-4 space-y-6">
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6">
                    <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2"><i class="far fa-clock"></i> Cronograma</h3>
                    <div class="grid grid-cols-3 gap-2" id="monthGrid"></div>
                </div>
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6">
                    <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4">Mix de Temas</h3>
                    <div class="chart-container"><canvas id="topicChart"></canvas></div>
                </div>
            </div>
            
            <div class="lg:col-span-8">
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 min-h-[600px] flex flex-col relative overflow-hidden">
                    <div class="h-1 w-full bg-gradient-to-r from-blue-600 via-purple-500 to-emerald-500"></div>
                    <div class="p-8 flex-1 flex flex-col">
                        <div class="flex justify-between items-start mb-8 border-b border-slate-100 pb-6">
                            <div>
                                <span class="text-xs font-bold text-blue-600 bg-blue-50 px-2.5 py-1 rounded-md uppercase tracking-wider" id="detailMonthLabel">JANEIRO</span>
                                <h2 class="text-3xl font-extrabold text-slate-900 tracking-tight mt-2" id="detailFocus">Foco</h2>
                            </div>
                            <button onclick="openAddModal()" class="btn-add-custom shadow-blue-900/20"><i class="fas fa-plus"></i> Adicionar Ação</button>
                        </div>
                        <div class="bg-slate-50/80 p-5 rounded-xl border border-slate-100 mb-8 backdrop-blur-sm">
                            <h4 class="text-xs font-bold text-slate-400 uppercase mb-2">Estratégia do Mês</h4>
                            <p class="text-slate-600 text-sm leading-relaxed" id="detailStrategy">...</p>
                        </div>
                        <div id="monthActions" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"></div>
                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2"><i class="fas fa-list-check"></i> Tarefas & Conteúdo</h3>
                        <div class="space-y-4 content-scroll overflow-y-auto pr-2 flex-1 pb-4" id="articlesList"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ESTRATÉGIA -->
        <div id="view-social" class="hidden-tab space-y-8 animate-fade-in">
            <div class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-3xl p-10 text-white shadow-2xl relative overflow-hidden group">
                <div class="absolute top-0 right-0 opacity-10 transform translate-x-10 -translate-y-10 group-hover:scale-110 transition-transform duration-700"><i class="fas fa-bullhorn text-9xl"></i></div>
                <div class="relative z-10 flex flex-col md:flex-row items-center justify-between gap-6">
                    <div>
                        <h2 class="text-3xl font-extrabold mb-3 tracking-tight">Distribuição & Multiplicação</h2>
                        <p class="text-slate-300 max-w-2xl text-base leading-relaxed">O segredo não é criar mais, é distribuir melhor. Siga o fluxo abaixo.</p>
                    </div>
                    <div class="bg-white/10 p-5 rounded-2xl backdrop-blur-md text-center border border-white/10 shadow-lg">
                        <span class="block text-4xl font-black text-emerald-400">6x</span>
                        <span class="text-[10px] text-slate-300 uppercase tracking-widest font-bold">Alcance</span>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-3xl shadow-sm border border-slate-100 p-8">
                    <h3 class="text-xl font-bold text-slate-800 mb-8 flex items-center gap-3"><div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600"><i class="fas fa-sliders-h"></i></div>Configuração Inicial</h3>
                    <div class="space-y-6">
                        <div class="social-card p-5 rounded-2xl border border-slate-100 border-l-4 border-l-blue-500 bg-blue-50/20 hover:bg-blue-50/40 transition-colors">
                            <div class="flex items-center justify-between mb-4"><span class="font-bold text-slate-800 text-sm flex items-center gap-2"><i class="fab fa-google text-blue-500 text-lg"></i> Google Meu Negócio</span><span class="text-[9px] bg-blue-100 text-blue-800 px-2 py-1 rounded-md font-bold uppercase">Essencial</span></div>
                            <div class="space-y-3 pl-1"><label class="flex items-start text-sm text-slate-600 cursor-pointer"><input type="checkbox" class="mt-1 mr-3 accent-blue-600 setup-check" data-id="gmb1"><span>Atualizar horário.</span></label><label class="flex items-start text-sm text-slate-600 cursor-pointer"><input type="checkbox" class="mt-1 mr-3 accent-blue-600 setup-check" data-id="gmb3"><span>Enviar link de avaliação.</span></label></div>
                        </div>
                        <div class="social-card p-5 rounded-2xl border border-slate-100 border-l-4 border-l-blue-700 bg-slate-50 hover:bg-slate-100 transition-colors">
                            <div class="flex items-center justify-between mb-4"><span class="font-bold text-slate-800 text-sm flex items-center gap-2"><i class="fab fa-linkedin text-blue-700 text-lg"></i> LinkedIn Pessoal</span></div>
                            <div class="space-y-3 pl-1"><label class="flex items-start text-sm text-slate-600 cursor-pointer"><input type="checkbox" class="mt-1 mr-3 accent-blue-700 setup-check" data-id="li1"><span>Atualizar foto de capa.</span></label></div>
                        </div>
                        <div class="social-card p-5 rounded-2xl border border-slate-100 border-l-4 border-l-amber-500 bg-amber-50/20 hover:bg-amber-50/40 transition-colors">
                            <div class="flex items-center justify-between mb-4"><span class="font-bold text-slate-800 text-sm flex items-center gap-2"><i class="fas fa-balance-scale text-amber-500 text-lg"></i> Jusbrasil</span><span class="text-[9px] bg-amber-100 text-amber-800 px-2 py-1 rounded-md font-bold uppercase">SEO</span></div>
                            <div class="space-y-3 pl-1"><label class="flex items-start text-sm text-slate-600 cursor-pointer"><input type="checkbox" class="mt-1 mr-3 accent-amber-500 setup-check" data-id="jb1"><span>Verificar link do site.</span></label><label class="flex items-start text-sm text-slate-600 cursor-pointer"><input type="checkbox" class="mt-1 mr-3 accent-amber-500 setup-check" data-id="jb2"><span>Ativar notificações.</span></label></div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-3xl shadow-sm border border-slate-100 p-8">
                    <h3 class="text-xl font-bold text-slate-800 mb-8 flex items-center gap-3"><div class="w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center text-emerald-600"><i class="fas fa-recycle"></i></div>Método de Multiplicação</h3>
                    <div class="relative pl-10 space-y-8 before:content-[''] before:absolute before:left-3.5 before:top-2 before:bottom-2 before:w-0.5 before:bg-slate-200">
                        <div class="relative group"><div class="absolute -left-[41px] bg-slate-800 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow">1</div><h4 class="font-bold text-slate-900 text-sm">Blog</h4></div>
                        <div class="relative group"><div class="absolute -left-[41px] bg-blue-700 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow">2</div><h4 class="font-bold text-slate-900 text-sm">LinkedIn</h4></div>
                        <div class="relative group"><div class="absolute -left-[41px] bg-amber-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow">3</div><h4 class="font-bold text-slate-900 text-sm">Jusbrasil (Delay 7 Dias)</h4></div>
                        <div class="relative group"><div class="absolute -left-[41px] bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow">4</div><h4 class="font-bold text-slate-900 text-sm">Instagram</h4></div>
                        <div class="relative group"><div class="absolute -left-[41px] bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow">5</div><h4 class="font-bold text-slate-900 text-sm">WhatsApp</h4></div>
                        <div class="relative group"><div class="absolute -left-[41px] bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shadow">6</div><h4 class="font-bold text-slate-900 text-sm">Google Meu Negócio</h4><p class="text-xs text-slate-500 mt-1">Postagem "Atualização" com botão Saiba Mais.</p></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RELATÓRIO -->
        <div id="view-report" class="hidden-tab animate-fade-in space-y-6">
            <div class="bg-indigo-50 border border-indigo-100 rounded-3xl p-8 flex flex-col md:flex-row justify-between items-center gap-6">
                <div><h3 class="font-bold text-indigo-900 text-lg mb-1 flex items-center gap-2"><i class="fas fa-shield-alt"></i> Segurança dos Dados</h3><p class="text-sm text-indigo-700 opacity-80">Seus dados são salvos localmente. Faça backups regulares.</p></div>
                <div class="flex gap-3">
                    <button onclick="downloadBackup()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-xl shadow-lg text-sm font-bold flex items-center gap-2"><i class="fas fa-download"></i> Baixar Backup</button>
                    <label class="bg-white text-indigo-700 border border-indigo-200 hover:bg-indigo-50 px-5 py-2.5 rounded-xl shadow-sm text-sm font-bold cursor-pointer flex items-center gap-2"><i class="fas fa-upload"></i> Restaurar<input type="file" id="backupInput" class="hidden" accept=".json" onchange="restoreBackup(this)"></label>
                </div>
            </div>
            
            <div class="bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden">
                <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-slate-50/50">
                    <h2 class="font-bold text-slate-800 text-lg">Relatório de Execução</h2>
                    <div class="flex items-center gap-3">
                        <div class="bg-white border border-slate-200 px-3 py-1.5 rounded-lg text-xs font-medium text-slate-600">Feitos: <span id="reportDoneCount" class="font-bold text-emerald-600 ml-1">0</span></div>
                        <button onclick="analyzeProgress()" class="sparkle-btn text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md flex items-center gap-2"><i class="fas fa-magic"></i> Analisar Desempenho</button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full spreadsheet-table">
                        <thead>
                            <tr>
                                <th class="w-24 pl-6">Mês</th>
                                <th class="w-32">Categoria</th>
                                <th>Ação / Conteúdo</th>
                                <th class="w-32 pr-6">Status</th>
                            </tr>
                        </thead>
                        <tbody id="reportTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

    </main>

    <!-- Modais (Settings, Add, IA) -->
    <div id="settingsModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md animate-fade-in overflow-hidden transform transition-all scale-100">
            <div class="bg-slate-900 p-5 flex justify-between items-center text-white"><h3 class="font-bold flex items-center gap-2">Configurar IA</h3><button onclick="closeSettingsModal()" class="text-slate-400 hover:text-white"><i class="fas fa-times text-xl"></i></button></div>
            <div class="p-6 space-y-5">
                <p class="text-sm text-slate-600">Insira sua API Key do Google Gemini.</p>
                <input type="password" id="userApiKey" class="w-full border p-3 rounded-xl outline-none" placeholder="Cole a chave AIzaSy... aqui">
                <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-xs text-blue-600 hover:underline block text-center">Obter chave gratuita</a>
                <button onclick="saveApiKey()" class="w-full bg-slate-900 text-white font-bold py-3.5 rounded-xl">SALVAR</button>
            </div>
        </div>
    </div>

    <div id="addModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md animate-fade-in overflow-hidden">
            <div class="bg-slate-900 p-5 flex justify-between items-center text-white"><h3 class="font-bold">Nova Ação Extra</h3><button onclick="closeAddModal()" class="text-slate-400 hover:text-white"><i class="fas fa-times text-xl"></i></button></div>
            <div class="p-6 space-y-5">
                <div><div class="flex justify-between mb-2"><label class="text-xs font-bold uppercase">Título</label><button onclick="suggestIdea()" class="text-xs text-blue-600 font-bold">Sugerir Ideia</button></div><input type="text" id="newActionTitle" class="w-full border p-3 rounded-xl outline-none"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div><label class="text-xs font-bold uppercase">Formato</label><select id="newActionType" class="w-full border p-3 rounded-xl outline-none"><option>Artigo</option><option>Post</option><option>Vídeo</option><option>Enquete</option><option>Carrossel</option><option>Foto</option></select></div>
                    <div><label class="text-xs font-bold uppercase">Canal</label><select id="newActionChannel" class="w-full border p-3 rounded-xl outline-none"><option>Instagram</option><option>LinkedIn</option><option>Site/Blog</option><option>Jusbrasil</option><option>Google Meu Negócio</option><option>WhatsApp</option><option>Facebook</option><option>X (Twitter)</option></select></div>
                </div>
                <button onclick="saveCustomAction()" class="w-full bg-blue-600 text-white font-bold py-3.5 rounded-xl">SALVAR AÇÃO</button>
            </div>
        </div>
    </div>

    <div id="aiModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col overflow-hidden animate-fade-in">
            <div class="bg-slate-900 p-5 flex justify-between items-center text-white"><h3 class="font-bold">Assistente Inteligente</h3><button onclick="closeModal()" class="text-slate-400 hover:text-white"><i class="fas fa-times text-xl"></i></button></div>
            <div class="p-8 overflow-y-auto flex-1 bg-slate-50" id="modalBody"></div>
            <div class="p-5 border-t bg-white flex justify-end gap-3">
                <button onclick="closeModal()" class="px-5 py-2.5 bg-slate-100 rounded-xl font-bold text-sm">Fechar</button>
                <button onclick="copyToClipboard()" class="px-5 py-2.5 bg-slate-900 text-white rounded-xl font-bold text-sm">Copiar Texto</button>
            </div>
        </div>
    </div>

    <script>
        const contentPlan=[{id:0,month:"Janeiro",focus:"Planejamento & Distratos",strategy:"Início de ano, foco em financeiro e distratos.",articles:[{id:'jan1',category:"Imobiliário",title:"Comprei imóvel na planta e me arrependi: Distrato 2026",keyword:"distrato",intent:"Educativo",completed:false},{id:'jan2',category:"Execução",title:"Defesa em Execução Cível: Protegendo bens",keyword:"defesa execução",intent:"Autoridade",completed:false},{id:'jan3',category:"Inventário",title:"Planejamento Sucessório: Começando o ano",keyword:"planejamento",intent:"Conscientização",completed:false}]},{id:1,month:"Fevereiro",focus:"Atrasos & Cobrança",strategy:"Volta às aulas/obras. Atrasos e cobranças.",articles:[{id:'fev1',category:"Imobiliário",title:"Atraso na entrega da obra: Indenizações",keyword:"atraso obra",intent:"Conversão",completed:false},{id:'fev2',category:"Execução",title:"Cobrança de Aluguel: Execução vs Despejo",keyword:"aluguel",intent:"Autoridade",completed:false},{id:'fev3',category:"Imobiliário",title:"Congelamento do Saldo Devedor",keyword:"saldo devedor",intent:"Educativo",completed:false}]},{id:2,month:"Março",focus:"Consumidor & IR",strategy:"Mês do consumidor e declaração de IR.",articles:[{id:'mar1',category:"Inventário",title:"Custos do Inventário Extrajudicial 2026",keyword:"custo inventário",intent:"Educativo",completed:false},{id:'mar2',category:"Imobiliário",title:"Cuidados na Compra de Imóvel na Planta",keyword:"compra planta",intent:"Prevenção",completed:false},{id:'mar3',category:"Execução",title:"Busca de Bens: Sisbajud e Renajud",keyword:"busca bens",intent:"Autoridade",completed:false}]},{id:3,month:"Abril",focus:"Prazos & Multas",strategy:"Multas de inventário e vícios construtivos.",articles:[{id:'abr1',category:"Inventário",title:"Multa no Inventário: Prazos",keyword:"multa inventário",intent:"Urgência",completed:false},{id:'abr2',category:"Imobiliário",title:"Vícios Construtivos e Garantia",keyword:"vícios obra",intent:"Educativo",completed:false},{id:'abr3',category:"Execução",title:"Título Extrajudicial: Documentos",keyword:"título extrajudicial",intent:"Educativo",completed:false}]},{id:4,month:"Maio",focus:"Família & Imóveis",strategy:"Mês das mães/noivas. Regime de bens.",articles:[{id:'mai1',category:"Imobiliário",title:"Compra de Imóvel e Regime de Bens",keyword:"regime bens",intent:"Educativo",completed:false},{id:'mai2',category:"Inventário",title:"Divergência entre Herdeiros: O que fazer?",keyword:"herdeiros",intent:"Solução",completed:false},{id:'mai3',category:"Execução",title:"Penhora de Salário: STJ",keyword:"penhora salário",intent:"Atualidade",completed:false}]},{id:5,month:"Junho",focus:"Revisão Contratual",strategy:"Meio de ano. Juros e fraudes.",articles:[{id:'jun1',category:"Imobiliário",title:"Juros de Obra: Legalidade",keyword:"juros obra",intent:"Conversão",completed:false},{id:'jun2',category:"Execução",title:"Fraude à Execução: Doação de bens",keyword:"fraude",intent:"Autoridade",completed:false},{id:'jun3',category:"Inventário",title:"Venda de Imóvel durante Inventário",keyword:"venda espólio",intent:"Solução",completed:false}]},{id:6,month:"Julho",focus:"Investidores",strategy:"Leilões e oportunidades.",articles:[{id:'jul1',category:"Imobiliário",title:"Leilões e Dívidas de Condomínio",keyword:"leilão",intent:"Nicho",completed:false},{id:'jul2',category:"Imobiliário",title:"Distrato por Culpa da Construtora",keyword:"culpa construtora",intent:"Conversão",completed:false},{id:'jul3',category:"Execução",title:"Prescrição de Dívidas",keyword:"prescrição",intent:"Educativo",completed:false}]},{id:7,month:"Agosto",focus:"Pais & Sucessão",strategy:"Dia dos pais. Doação vs Inventário.",articles:[{id:'ago1',category:"Inventário",title:"Doação em Vida vs Inventário",keyword:"doação",intent:"Comparativo",completed:false},{id:'ago2',category:"Execução",title:"Bem de Família e Penhora",keyword:"bem família",intent:"Defesa",completed:false},{id:'ago3',category:"Imobiliário",title:"Corretagem no Distrato",keyword:"corretagem",intent:"Dúvida",completed:false}]},{id:8,month:"Setembro",focus:"Consumidor",strategy:"Defesa contra abusos.",articles:[{id:'set1',category:"Imobiliário",title:"Cláusulas Abusivas em Contratos",keyword:"abusivas",intent:"Autoridade",completed:false},{id:'set2',category:"Execução",title:"Cobrança de Cheque e Nota Promissória",keyword:"cheque",intent:"Educativo",completed:false},{id:'set3',category:"Inventário",title:"Inventário com Testamento",keyword:"testamento",intent:"Atualidade",completed:false}]},{id:9,month:"Outubro",focus:"Reta Final",strategy:"Acelerar execuções e vistorias.",articles:[{id:'out1',category:"Execução",title:"Recuperação de Crédito antes do Recesso",keyword:"recuperação",intent:"Estratégia",completed:false},{id:'out2',category:"Imobiliário",title:"Checklist de Vistoria de Chaves",keyword:"vistoria",intent:"Utilidade",completed:false},{id:'out3',category:"Imobiliário",title:"Distrato por Negativa de Financiamento",keyword:"financiamento",intent:"Dor",completed:false}]},{id:10,month:"Novembro",focus:"Oportunidades",strategy:"Black Friday e 13º.",articles:[{id:'nov1',category:"Imobiliário",title:"Cuidados na Black Friday Imobiliária",keyword:"black friday",intent:"Alerta",completed:false},{id:'nov2',category:"Inventário",title:"Usando 13º para pagar ITCMD",keyword:"itcmd",intent:"Solução",completed:false},{id:'nov3',category:"Execução",title:"Penhora de Faturamento",keyword:"faturamento",intent:"Avançado",completed:false}]},{id:11,month:"Dezembro",focus:"Retrospectiva",strategy:"Recesso e planejamento.",articles:[{id:'dez1',category:"Geral",title:"Recesso Forense e Prazos",keyword:"recesso",intent:"Informativo",completed:false},{id:'dez2',category:"Imobiliário",title:"Atraso de Obra em Dezembro",keyword:"atraso",intent:"Prático",completed:false},{id:'dez3',category:"Inventário",title:"Regularizando bens de gerações passadas",keyword:"bens antigos",intent:"Complexidade",completed:false}]}];
        const STORAGE_KEY = 'adv_marketing_2026_v19';
        let customActions = []; let currentMonthId = 0;

        function loadState(){try{const s=localStorage.getItem(STORAGE_KEY);if(s){const st=JSON.parse(s);contentPlan.forEach(m=>m.articles.forEach(a=>{if(st.status&&st.status[a.id])a.completed=true}));if(st.customActions)customActions=st.customActions;if(st.socialSetup)setTimeout(()=>{document.querySelectorAll('.setup-check').forEach(el=>{if(st.socialSetup[el.getAttribute('data-id')])el.checked=true})},500)}const k=localStorage.getItem('gemini_api_key');if(k)document.getElementById('userApiKey').value=k}catch(e){}}
        function saveState(){const s={status:{},socialSetup:{},customActions:customActions};contentPlan.forEach(m=>m.articles.forEach(a=>{if(a.completed)s.status[a.id]=true}));document.querySelectorAll('.setup-check').forEach(el=>{if(el.checked)s.socialSetup[el.getAttribute('data-id')]=true});localStorage.setItem(STORAGE_KEY,JSON.stringify(s))}
        function openSettingsModal(){document.getElementById('settingsModal').classList.remove('hidden')}
        function closeSettingsModal(){document.getElementById('settingsModal').classList.add('hidden')}
        function saveApiKey(){const k=document.getElementById('userApiKey').value.trim();if(k){localStorage.setItem('gemini_api_key',k);alert('Chave salva!');closeSettingsModal()}else alert('Chave inválida')}
        
        function renderCalendar(){const g=document.getElementById('monthGrid');g.innerHTML='';contentPlan.forEach(i=>{const b=document.createElement('button');b.className=`p-2 rounded-lg text-xs font-bold transition-all border ${i.id===currentMonthId?'bg-slate-800 text-white shadow-md':'bg-white text-slate-500 hover:bg-slate-50'}`;b.innerHTML=i.month.substr(0,3);b.onclick=()=>loadMonth(i.id);g.appendChild(b)})}
        function loadMonth(id){currentMonthId=id;const d=contentPlan[id];document.getElementById('detailMonthLabel').textContent=d.month.toUpperCase();document.getElementById('detailFocus').textContent=d.focus;document.getElementById('detailStrategy').textContent=d.strategy;
        document.getElementById('monthActions').innerHTML=`<button onclick="generateNewsletter(${id})" class="action-btn btn-newsletter hover:border-blue-300 hover:bg-blue-50/50"><i class="fas fa-envelope-open-text text-blue-500 text-lg"></i> Gerar Newsletter</button><button onclick="generateStories(${id})" class="action-btn btn-stories hover:border-pink-300 hover:bg-pink-50/50"><i class="fas fa-camera text-pink-500 text-lg"></i> Roteiro Stories</button>`;
        renderCalendar();document.getElementById('articlesList').innerHTML='';d.articles.forEach(a=>renderCard(a,false));customActions.filter(c=>c.monthId===id).forEach(a=>renderCard(a,true))}
        
        function renderCard(i,c){const d=document.createElement('div');const type=c?i.type:'Artigo';const ch=c?i.channel:'Blog';d.className=`article-card p-5 rounded-xl bg-white shadow-sm border border-gray-100 ${i.completed?'completed':''} ${c?'border-custom':(i.category.includes('Imob')?'border-imob':i.category.includes('Inv')?'border-inv':'border-exec')}`;
        d.innerHTML=`<div class="flex gap-4 items-start"><div class="pt-1"><input type="checkbox" class="w-5 h-5 accent-emerald-500 cursor-pointer rounded" ${i.completed?'checked':''} onchange="${c?`toggleCustom('${i.id}')`:`toggleArticle('${i.id}')`}"></div><div class="w-full"><div class="flex justify-between mb-2"><span class="text-[10px] font-bold uppercase tracking-wider text-slate-400 flex items-center gap-1.5">${c?getTypeIcon(type):'<i class="fas fa-file-alt"></i>'} ${c?i.type:i.category}</span>${c?`<span class="badge-channel bg-slate-50 text-slate-600 border-slate-200">${i.channel}</span>`:''}</div><h4 class="font-bold text-slate-800 leading-snug mb-3 text-[15px]">${i.title}</h4><div class="flex justify-end"><button onclick="generateAI('${i.title.replace(/'/g,"\\'")}','${type}','${ch}')" class="sparkle-btn text-white text-[10px] px-3 py-1.5 rounded-lg font-bold shadow-sm flex items-center gap-1.5"><i class="fas fa-wand-magic-sparkles"></i> Gerar c/ IA</button></div></div></div>`;document.getElementById('articlesList').appendChild(d)}
        function toggleArticle(id){contentPlan.forEach(m=>m.articles.forEach(a=>{if(a.id===id)a.completed=!a.completed}));saveState();loadMonth(currentMonthId);updateProgress()}
        function toggleCustom(id){const a=customActions.find(c=>c.id===id);if(a)a.completed=!a.completed;saveState();loadMonth(currentMonthId);updateProgress()}
        function updateProgress(){let t=0,d=0;contentPlan.forEach(m=>m.articles.forEach(a=>{t++;if(a.completed)d++}));customActions.forEach(a=>{t++;if(a.completed)d++});document.getElementById('globalProgressText').innerText=`${d}/${t}`;document.getElementById('globalProgressBar').style.width=`${(t>0?(d/t)*100:0)}%`}
        function openAddModal(){document.getElementById('addModal').classList.remove('hidden')}
        function closeAddModal(){document.getElementById('addModal').classList.add('hidden');document.getElementById('newActionTitle').value=''}
        function saveCustomAction(){const t=document.getElementById('newActionTitle').value;if(!t)return;customActions.push({id:'cust_'+Date.now(),monthId:currentMonthId,title:t,type:document.getElementById('newActionType').value,channel:document.getElementById('newActionChannel').value,completed:false,isCustom:true});saveState();loadMonth(currentMonthId);closeAddModal()}
        function getTypeIcon(t){return t==='Artigo'?'<i class="fas fa-file-alt"></i>':t==='Foto'?'<i class="fas fa-camera"></i>':t==='Carrossel'?'<i class="fas fa-images"></i>':t==='Enquete'?'<i class="fas fa-poll"></i>':t==='Vídeo'?'<i class="fas fa-video"></i>':t==='Post'?'<i class="fas fa-comment-dots"></i>':'';}
        function downloadBackup(){const s={status:{},socialSetup:{},customActions:customActions};contentPlan.forEach(m=>m.articles.forEach(a=>{if(a.completed)s.status[a.id]=true}));document.querySelectorAll('.setup-check').forEach(el=>{if(el.checked)s.socialSetup[el.getAttribute('data-id')]=true});const d="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(s));const a=document.createElement('a');a.href=d;a.download=`backup_juridico_${new Date().toISOString().slice(0,10)}.json`;document.body.appendChild(a);a.click();a.remove()}
        function restoreBackup(i){const f=i.files[0];if(!f)return;const r=new FileReader();r.onload=function(e){try{const s=JSON.parse(e.target.result);contentPlan.forEach(m=>m.articles.forEach(a=>{a.completed=!!(s.status&&s.status[a.id])}));if(s.customActions)customActions=s.customActions;if(s.socialSetup)document.querySelectorAll('.setup-check').forEach(el=>{el.checked=!!s.socialSetup[el.getAttribute('data-id')]});saveState();loadMonth(currentMonthId);renderReport();updateProgress();alert('Restaurado!')}catch(err){alert('Erro')}};r.readAsText(f)}
        function switchTab(id){document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));document.getElementById('tab-'+id).classList.add('active');['view-calendar','view-social','view-report'].forEach(v=>document.getElementById(v).classList.add('hidden-tab'));document.getElementById('view-'+id).classList.remove('hidden-tab');document.getElementById('view-'+id).classList.add('animate-fade-in');if(id==='report')renderReport()}
        
        function renderReport(){const b=document.getElementById('reportTableBody');b.innerHTML='';let r=[];contentPlan.forEach(m=>m.articles.forEach(a=>r.push({m:m.month,t:a.category,d:a.title,s:a.completed})));customActions.forEach(a=>r.push({m:contentPlan[a.monthId].month,t:`${a.type} (${a.channel})`,d:a.title,s:a.completed}));document.getElementById('reportDoneCount').innerText=r.filter(x=>x.s).length;r.forEach(x=>{b.innerHTML+=`<tr class="${x.s?'bg-green-50/50':''}"><td>${x.m}</td><td class="text-[10px] font-bold text-slate-400 uppercase">${x.t}</td><td class="text-[10px] font-bold text-slate-700">${x.d}</td><td>${x.s?'<span class="status-done"><i class="fas fa-check"></i> Feito</span>':'<span class="status-pending"><i class="far fa-circle"></i> Pendente</span>'}</td></tr>`})}
        
        const m=document.getElementById('aiModal'),mb=document.getElementById('modalBody');function closeModal(){m.classList.add('hidden')}function copyToClipboard(){const r=document.createRange();r.selectNode(mb);window.getSelection().addRange(r);document.execCommand('copy')}
        async function callGemini(p,l){const k=localStorage.getItem('gemini_api_key');if(!k){openSettingsModal();return}m.classList.remove('hidden');mb.innerHTML=`<div class="flex flex-col items-center justify-center h-64 text-center animate-pulse"><div class="text-5xl mb-4">✨</div><h3 class="text-xl font-bold text-slate-700">${l}</h3><p class="text-slate-500 mt-2 text-sm">Aguarde um momento...</p></div>`;try{const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${k}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:p}]}]})});if(!r.ok)throw new Error(r.statusText);const j=await r.json();mb.innerHTML=`<div class="prose prose-sm max-w-none prose-slate">${marked.parse(j.candidates[0].content.parts[0].text)}</div>`}catch(e){mb.innerHTML=`<div class="text-center text-red-500 font-bold p-8">Erro na conexão: ${e.message}<br><br>Verifique sua Chave API nas configurações (⚙️).</div>`}}
        function generateAI(t,p1,p2){callGemini(`Advogado. Crie: "${t}". Tipo: ${p1}. Canal: ${p2}. Foco: Marketing Jurídico. Markdown.`,"Criando...")}
        function generateNewsletter(id){const d=contentPlan[id];callGemini(`Newsletter Jurídica ${d.month}. Temas: ${d.articles.map(a=>a.title).join(', ')}. Markdown.`,"Escrevendo...")}
        function generateStories(id){const d=contentPlan[id];callGemini(`Roteiro Stories Instagram. Tema: ${d.focus}. Inclua Enquete e Caixinha.`,"Criando...")}
        async function suggestIdea(){const k=localStorage.getItem('gemini_api_key');if(!k){openSettingsModal();return}const d=contentPlan[currentMonthId];const b=document.querySelector('#addModal button i.fa-lightbulb').parentNode;b.innerHTML='...';try{const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${k}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:`Ideia curta título marketing jurídico ${d.month}, foco ${d.focus}. Apenas título.`}]}]})});const j=await r.json();document.getElementById('newActionTitle').value=j.candidates[0].content.parts[0].text.trim().replace(/"/g,'')}catch(e){}b.innerHTML='<i class="fas fa-lightbulb"></i> Sugerir Ideia'}
        function analyzeProgress(){let d=0,t=0;contentPlan.forEach(m=>m.articles.forEach(a=>{t++;if(a.completed)d++}));callGemini(`Mentor Carreira Jurídica. Analise: Planejado: ${t}, Feito: ${d}. Feedback curto.`,"Analisando...")}

        window.onload=()=>{loadState();loadMonth(0);updateProgress();let i=0,v=0,e=0;contentPlan.forEach(m=>m.articles.forEach(a=>{if(a.category.includes('Imob'))i++;else if(a.category.includes('Inv'))v++;else e++}));new Chart(document.getElementById('topicChart').getContext('2d'),{type:'doughnut',data:{labels:['Imob','Inv','Exec'],datasets:[{data:[i,v,e],backgroundColor:['#3b82f6','#10b981','#ef4444'],borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,cutout:'75%',plugins:{legend:{display:false}}}})}
    </script>
</body>
</html>